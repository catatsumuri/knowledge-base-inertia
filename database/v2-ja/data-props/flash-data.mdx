---
title: フラッシュデータ
---

<Badge>v2.3.3+</Badge>

場合によっては、ブラウザの履歴を移動したときに再表示されてほしくない、一度きりのデータをフロントエンドに送信したいことがあります。通常の props と異なり、フラッシュデータは履歴の state に永続化されないため、成功メッセージ、新しく作成された ID、その他の一時的な値に最適です。

## データをフラッシュする

`Inertia::flash()` メソッドを使用して、キーと値、またはキーと値の配列を渡すことでデータをフラッシュできます。

```php
public function store(Request $request)
{
    $user = User::create($request->validated());

    Inertia::flash('message', 'ユーザーが正常に作成されました！');

    // または、複数の値を一度にフラッシュすることもできます...
    Inertia::flash([
        'message' => 'ユーザーが作成されました！',
        'newUserId' => $user->id,
    ]);

    return back();
}
```

`back()` とのチェーンもサポートされています。

```php
return Inertia::flash('newUserId', $user->id)->back();
```

`render()` に `flash()` をチェーンすることも、その逆も可能です。

```php
return Inertia::render('Projects/Index', [
    'projects' => $projects,
])->flash('highlight', $project->id);

// または...

return Inertia::flash('highlight', $project->id)
    ->render('Projects/Index', ['projects' => $projects]);
```

フラッシュデータは現在のリクエストにスコープされます。リダイレクト時には、ミドルウェアが自動的にセッションへ永続化します。フラッシュデータがクライアントに送信されるとクリアされ、以降のリクエストでは表示されません。

## フラッシュデータへのアクセス

フラッシュデータは `page.flash` で利用できます。また、グローバルな `flash` イベントをリッスンするか、`onFlash` コールバックを使用することもできます。

<CodeGroup>

```vue Vue icon="vuejs"
<script setup>
import { usePage } from '@inertiajs/vue3'

const page = usePage()
</script>

<template>
    <div v-if="page.flash.toast" class="toast">
        {{ page.flash.toast.message }}
    </div>
</template>
```

```jsx React icon="react"
import { usePage } from '@inertiajs/react'

export default function Layout({ children }) {
    const { flash } = usePage()

    return (
        <>
            {flash.toast && <div className="toast">{flash.toast.message}</div>}
            {children}
        </>
    )
}
```

```svelte Svelte icon="s"
<script>
    import { page } from '@inertiajs/svelte'
</script>

{#if $page.flash.toast}
    <div class="toast">{$page.flash.toast.message}</div>
{/if}
```

</CodeGroup>

## onFlash コールバック

リクエストを行う際に、`onFlash` コールバックを使用してフラッシュデータを処理できます。

<CodeGroup>

```js Vue icon="vuejs"
import { router } from '@inertiajs/vue3'

router.post('/users', data, {
    onFlash: ({ newUserId }) => {
        form.userId = newUserId
    },
})
```

```js React icon="react"
import { router } from '@inertiajs/react'

router.post('/users', data, {
    onFlash: ({ newUserId }) => {
        form.userId = newUserId
    },
})
```

```js Svelte icon="s"
import { router } from '@inertiajs/svelte'

router.post('/users', data, {
    onFlash: ({ newUserId }) => {
        form.userId = newUserId
    },
})
```

</CodeGroup>

## グローバルフラッシュイベント

レイアウトコンポーネントなど、中央集約的な場所でフラッシュデータを処理するために、グローバルな `flash` イベントを使用できます。イベントの詳細については、[イベントのドキュメント](/v2/advanced/events) を参照してください。

<CodeGroup>

```js Vue icon="vuejs"
import { router } from '@inertiajs/vue3'

router.on('flash', (event) => {
    if (event.detail.flash.toast) {
        showToast(event.detail.flash.toast)
    }
})
```

```js React icon="react"
import { router } from '@inertiajs/react'

router.on('flash', (event) => {
    if (event.detail.flash.toast) {
        showToast(event.detail.flash.toast)
    }
})
```

```js Svelte icon="s"
import { router } from '@inertiajs/svelte'

router.on('flash', (event) => {
    if (event.detail.flash.toast) {
        showToast(event.detail.flash.toast)
    }
})
```

</CodeGroup>

<Warning>
コンポーネント内で登録されたイベントリスナーは、コンポーネントのアンマウント時にクリーンアップする必要があります。そうしないと、リスナーが蓄積され、複数回発火してしまいます。これは特に非永続レイアウトで重要です。詳細は [イベントリスナーの削除](/v2/advanced/events#removing-listeners) を参照してください。
</Warning>

ネイティブのブラウザイベントもサポートされています。

<CodeGroup>

```js Vue icon="vuejs"
document.addEventListener('inertia:flash', (event) => {
    console.log(event.detail.flash)
})
```

```js React icon="react"
document.addEventListener('inertia:flash', (event) => {
    console.log(event.detail.flash)
})
```

```js Svelte icon="s"
document.addEventListener('inertia:flash', (event) => {
    console.log(event.detail.flash)
})
```

</CodeGroup>

`flash` イベントはキャンセルできません。[部分的なリロード](/v2/data-props/partial-reloads) 中は、フラッシュデータが変更された場合にのみ発火します。

## クライアントサイドのフラッシュ

`router.flash()` メソッドを使用すると、サーバーリクエストなしでクライアント側からフラッシュデータを設定できます。値は既存のフラッシュデータとマージされます。

<CodeGroup>

```js Vue icon="vuejs"
import { router } from '@inertiajs/vue3'

router.flash('foo', 'bar')
router.flash({ foo: 'bar' })
```

```js React icon="react"
import { router } from '@inertiajs/react'

router.flash('foo', 'bar')
router.flash({ foo: 'bar' })
```

```js Svelte icon="s"
import { router } from '@inertiajs/svelte'

router.flash('foo', 'bar')
router.flash({ foo: 'bar' })
```

</CodeGroup>

現在のフラッシュデータにアクセスしたり、完全に置き換えたりするために、コールバックを渡すこともできます。

<CodeGroup>

```js Vue icon="vuejs"
import { router } from '@inertiajs/vue3'

router.flash((current) => ({ ...current, bar: 'baz' }))
router.flash(() => ({}))
```

```js React icon="react"
import { router } from '@inertiajs/react'

router.flash((current) => ({ ...current, bar: 'baz' }))
router.flash(() => ({}))
```

```js Svelte icon="s"
import { router } from '@inertiajs/svelte'

router.flash((current) => ({ ...current, bar: 'baz' }))
router.flash(() => ({}))
```

</CodeGroup>

## TypeScript

[TypeScript の宣言マージ](/v2/advanced/typescript#flash-data) を使用して、フラッシュデータの型をグローバルに設定できます。

## テスト

フラッシュデータのテストについては、[テストのドキュメント](/v2/advanced/testing#testing-flash-data) を参照してください。
