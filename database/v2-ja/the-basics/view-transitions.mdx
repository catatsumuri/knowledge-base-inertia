---
title: ビュー遷移
---

<Badge>v2.2.13+</Badge>

Inertia は [View Transitions API](https://developer.chrome.com/docs/web-platform/view-transitions) をサポートしており、ページ遷移をアニメーション化できます。

View Transitions API は[比較的新しいブラウザ機能](https://caniuse.com/view-transitions)です。Inertia は、この API をサポートしていないブラウザでは標準のページ遷移にフォールバックします。

## 遷移を有効にする

`viewTransition` オプションを `true` に設定することで、訪問時にビュー遷移を有効にできます。デフォルトでは、ページ間にクロスフェードの遷移が適用されます。

<CodeGroup>

```js Vue icon="vuejs"
import { router } from '@inertiajs/vue3'

router.visit('/another-page', { viewTransition: true })
```

```js React icon="react"
import { router } from '@inertiajs/react'

router.visit('/another-page', { viewTransition: true })
```

```js Svelte icon="s"
import { router } from '@inertiajs/svelte'

router.visit('/another-page', { viewTransition: true })
```

</CodeGroup>

## 遷移コールバック

`viewTransition` オプションにはコールバックを渡すこともでき、そのコールバックはブラウザから提供される標準の [`ViewTransition`](https://developer.mozilla.org/en-US/docs/Web/API/ViewTransition) インスタンスを受け取ります。これにより、API が提供するさまざまな Promise にフックできます。

<CodeGroup>

```js Vue icon="vuejs"
import { router } from '@inertiajs/vue3'

router.visit('/another-page', {
    viewTransition: (transition) => {
        transition.ready.then(() => console.log('Transition ready'))
        transition.updateCallbackDone.then(() => console.log('DOM updated'))
        transition.finished.then(() => console.log('Transition finished'))
    },
})
```

```js React icon="react"
import { router } from '@inertiajs/react'

router.visit('/another-page', {
    viewTransition: (transition) => {
        transition.ready.then(() => console.log('Transition ready'))
        transition.updateCallbackDone.then(() => console.log('DOM updated'))
        transition.finished.then(() => console.log('Transition finished'))
    },
})
```

```js Svelte icon="s"
import { router } from '@inertiajs/svelte'

router.visit('/another-page', {
    viewTransition: (transition) => {
        transition.ready.then(() => console.log('Transition ready'))
        transition.updateCallbackDone.then(() => console.log('DOM updated'))
        transition.finished.then(() => console.log('Transition finished'))
    },
})
```

</CodeGroup>

## リンク

`viewTransition` オプションは `Link` コンポーネントでも利用できます。

<CodeGroup>

```vue Vue icon="vuejs"
import { Link } from '@inertiajs/vue3'

<Link href="/another-page" view-transition>移動</Link>
```

```jsx React icon="react"
import { Link } from '@inertiajs/react'

<Link href="/another-page" viewTransition>移動</Link>
```

```svelte Svelte icon="s"
import { Link } from '@inertiajs/svelte'

<Link href="/another-page" viewTransition>移動</Link>
```

</CodeGroup>

`ViewTransition` インスタンスにアクセスするためのコールバックを渡すこともできます。

<CodeGroup>

```vue Vue icon="vuejs"
import { Link } from '@inertiajs/vue3'

<Link
    href="/another-page"
    :view-transition="(transition) => transition.finished.then(() => console.log('Done'))"
>
    移動
</Link>
```

```jsx React icon="react"
import { Link } from '@inertiajs/react'

<Link
    href="/another-page"
    viewTransition={(transition) => transition.finished.then(() => console.log('Done'))}
>
    移動
</Link>
```

```svelte Svelte icon="s"
import { Link } from '@inertiajs/svelte'

<Link
    href="/another-page"
    viewTransition={(transition) => transition.finished.then(() => console.log('Done'))}
>
    移動
</Link>
```

</CodeGroup>

## グローバル設定

[Inertia アプリを初期化する際](/v2/installation/client-side-setup#configuring-defaults)に `visitOptions` コールバックを設定することで、すべての訪問に対してグローバルにビュー遷移を有効にできます。

<CodeGroup>

```js Vue icon="vuejs"
import { createInertiaApp } from '@inertiajs/vue3'

createInertiaApp({
    // ...
    defaults: {
        visitOptions: (href, options) => {
            return { viewTransition: true }
        },
    },
})
```

```jsx React icon="react"
import { createInertiaApp } from '@inertiajs/react'

createInertiaApp({
    // ...
    defaults: {
        visitOptions: (href, options) => {
            return { viewTransition: true }
        },
    },
})
```

```js Svelte icon="s"
import { createInertiaApp } from '@inertiajs/svelte'

createInertiaApp({
    // ...
    defaults: {
        visitOptions: (href, options) => {
            return { viewTransition: true }
        },
    },
})
```

</CodeGroup>

## 遷移のカスタマイズ

CSS を使用して遷移アニメーションをカスタマイズできます。View Transitions API は、カスタムアニメーションを作成するために CSS で指定できる複数の疑似要素を使用します。以下の例は、[Chrome のドキュメント](https://developer.chrome.com/docs/web-platform/view-transitions/same-document#customize_the_transition) から引用したものです。

```css
@keyframes fade-in {
    from { opacity: 0; }
}
@keyframes fade-out {
    to { opacity: 0; }
}
@keyframes slide-from-right {
    from { transform: translateX(30px); }
}
@keyframes slide-to-left {
    to { transform: translateX(-30px); }
}
::view-transition-old(root) {
    animation: 90ms cubic-bezier(0.4, 0, 1, 1) both fade-out,
    300ms cubic-bezier(0.4, 0, 0.2, 1) both slide-to-left;
}
::view-transition-new(root) {
    animation: 210ms cubic-bezier(0, 0, 0.2, 1) 90ms both fade-in,
    300ms cubic-bezier(0.4, 0, 0.2, 1) both slide-from-right;
}
```

また、各要素に一意の `view-transition-name` を割り当てることで、ページ間で個別の要素をアニメーションさせることもできます。たとえば、プロフィールページでは大きく、ダッシュボードでは小さく表示されるアバターをアニメーションさせることができます。

<CodeGroup>

```vue Vue icon="vuejs"
<!-- Profile.vue -->
<template>
    <img src="/avatar.jpg" alt="ユーザー" class="avatar-large" />
</template>

<style>
.avatar-large {
    view-transition-name: user-avatar;
    width: auto;
    height: 200px;
}
</style>

<!-- Dashboard.vue -->
<template>
    <img src="/avatar.jpg" alt="ユーザー" class="avatar-small" />
</template>

<style>
.avatar-small {
    view-transition-name: user-avatar;
    width: auto;
    height: 40px;
}
</style>
```

```jsx React icon="react"
// Profile.jsx
export default function Profile() {
    return <img src="/avatar.jpg" alt="ユーザー" className="avatar-large" />
}

// CSS
.avatar-large {
    view-transition-name: user-avatar;
    width: auto;
    height: 200px;
}

// Dashboard.jsx
export default function Dashboard() {
    return <img src="/avatar.jpg" alt="ユーザー" className="avatar-small" />
}

// CSS
.avatar-small {
    view-transition-name: user-avatar;
    width: auto;
    height: 40px;
}
```

```svelte Svelte icon="s"
<!-- Profile.svelte -->
<img src="/avatar.jpg" alt="ユーザー" class="avatar-large" />

<style>
.avatar-large {
    view-transition-name: user-avatar;
    width: auto;
    height: 200px;
}
</style>

<!-- Dashboard.svelte -->
<img src="/avatar.jpg" alt="ユーザー" class="avatar-small" />

<style>
.avatar-small {
    view-transition-name: user-avatar;
    width: auto;
    height: 40px;
}
</style>
```

</CodeGroup>

任意の CSS アニメーションを使用して、ビュー遷移を自由にカスタマイズできます。詳しくは、[View Transitions API のドキュメント](https://developer.chrome.com/docs/web-platform/view-transitions/same-document#customize_the_transition) を参照してください。
